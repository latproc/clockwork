/* This script is intended to be used in conjunction with the device manager
(TBD more info needed). It provides a machine that switches state permanently
if the machine under observation ever receives a "disconnected" status.
*/

Watcher MACHINE status_machine {

    seen_discon WHEN SELF IS seen_discon || (SELF IS connected && status_machine.status == "disconnected");
    connected WHEN status_machine.status == "connected";
    watching DEFAULT;
}

Status MACHINE {
    OPTION status "";
}
status Status;
watcher Watcher status;
