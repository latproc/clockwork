PFLAG MACHINE {
	OPTION PERSISTENT true;
	OPTION VALUE off;
	OPTION export rw;

	on WHEN VALUE IS on;
	off DEFAULT;

	COMMAND turnOn {
		VALUE := on;
	}

	COMMAND turnOff {
		VALUE := off;
	}

#	ENTER INIT {
#		VALUE := off;
#	}

	TRANSITION off TO on ON turnOn;
	TRANSITION on TO off ON turnOff;
}

MFLAG MACHINE {
	OPTION PERSISTENT true;
	OPTION export rw;
	OPTION Count 0;
	OPTION VALUE off;
	EXPORT READWRITE 32BIT Count;

	on WHEN VALUE IS on;
	off DEFAULT;

	COMMAND turnOn {
		VALUE := on;
		Count := Count + 1;
	}

	COMMAND turnOff {
		VALUE := off;
	}

#	ENTER INIT {
#		VALUE := off;
#	}

	TRANSITION off TO on ON turnOn;
	TRANSITION on TO off ON turnOff;
}

Fault_A PFLAG(tab:Test);
Fault_B PFLAG(tab:Test);
FaultCondition MACHINE {
	GLOBAL Fault_A, Fault_B;
	true WHEN Fault_A IS on OR Fault_B IS on;
	false DEFAULT;
}

TEST CONSTANT 3;

Control MACHINE {

    FaultStatus FaultCondition(tab:Test);

    ENTER INIT { my_test := TEST; LOG "control init"; }

    fault WHEN FaultStatus IS true;
    ready DEFAULT;
    
    ENTER fault { LOG "fault" }

}
control Control(tab:Test);
