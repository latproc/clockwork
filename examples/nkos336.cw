# This is a stress test based on the machine 
# discussed in New Kind of Science, Wolfram S., p336
#
# The test does not attempt to directly reproduce 
# the original machine since it does not bother 
# to process the board in stages.

# In brief; a cell counts the number of black vs white 
#cells in its neighbourhood, including itself;

Cell MACHINE neighbours {

	white WHEN COUNT black FROM neighbours < 4
		OR COUNT black FROM neighbours == 5;
	black WHEN COUNT black FROM neighbours >=6
		OR COUNT black FROM neighbours == 4;

	# commands used during initialisation
	black DURING goBlack {  }
	white DURING goWhite {  }

	ENTER INIT { CALL reset ON SELF; }
	COMMAND reset {
		x := RANDOM;
		IF (RANDOM % 2 == 1) { CALL goBlack ON SELF } ELSE { CALL goWhite ON SELF } 
	}
}

# below is an instantiation of a grid of cells and their neighbours
# lines following this comment are generated by the script gen336.sh
l0000 LIST  c0909, c0900, c0901, c0009, c0000, c0001, c0109, c0100, c0101;
c0000 Cell l0000;
l0001 LIST  c0900, c0901, c0902, c0000, c0001, c0002, c0100, c0101, c0102;
c0001 Cell l0001;
l0002 LIST  c0901, c0902, c0903, c0001, c0002, c0003, c0101, c0102, c0103;
c0002 Cell l0002;
l0003 LIST  c0902, c0903, c0904, c0002, c0003, c0004, c0102, c0103, c0104;
c0003 Cell l0003;
l0004 LIST  c0903, c0904, c0905, c0003, c0004, c0005, c0103, c0104, c0105;
c0004 Cell l0004;
l0005 LIST  c0904, c0905, c0906, c0004, c0005, c0006, c0104, c0105, c0106;
c0005 Cell l0005;
l0006 LIST  c0905, c0906, c0907, c0005, c0006, c0007, c0105, c0106, c0107;
c0006 Cell l0006;
l0007 LIST  c0906, c0907, c0908, c0006, c0007, c0008, c0106, c0107, c0108;
c0007 Cell l0007;
l0008 LIST  c0907, c0908, c0909, c0007, c0008, c0009, c0107, c0108, c0109;
c0008 Cell l0008;
l0009 LIST  c0908, c0909, c0900, c0008, c0009, c0000, c0108, c0109, c0100;
c0009 Cell l0009;
r00 LIST  c0000, c0001, c0002, c0003, c0004, c0005, c0006, c0007, c0008, c0009;
l0100 LIST  c0009, c0000, c0001, c0109, c0100, c0101, c0209, c0200, c0201;
c0100 Cell l0100;
l0101 LIST  c0000, c0001, c0002, c0100, c0101, c0102, c0200, c0201, c0202;
c0101 Cell l0101;
l0102 LIST  c0001, c0002, c0003, c0101, c0102, c0103, c0201, c0202, c0203;
c0102 Cell l0102;
l0103 LIST  c0002, c0003, c0004, c0102, c0103, c0104, c0202, c0203, c0204;
c0103 Cell l0103;
l0104 LIST  c0003, c0004, c0005, c0103, c0104, c0105, c0203, c0204, c0205;
c0104 Cell l0104;
l0105 LIST  c0004, c0005, c0006, c0104, c0105, c0106, c0204, c0205, c0206;
c0105 Cell l0105;
l0106 LIST  c0005, c0006, c0007, c0105, c0106, c0107, c0205, c0206, c0207;
c0106 Cell l0106;
l0107 LIST  c0006, c0007, c0008, c0106, c0107, c0108, c0206, c0207, c0208;
c0107 Cell l0107;
l0108 LIST  c0007, c0008, c0009, c0107, c0108, c0109, c0207, c0208, c0209;
c0108 Cell l0108;
l0109 LIST  c0008, c0009, c0000, c0108, c0109, c0100, c0208, c0209, c0200;
c0109 Cell l0109;
r01 LIST  c0100, c0101, c0102, c0103, c0104, c0105, c0106, c0107, c0108, c0109;
l0200 LIST  c0109, c0100, c0101, c0209, c0200, c0201, c0309, c0300, c0301;
c0200 Cell l0200;
l0201 LIST  c0100, c0101, c0102, c0200, c0201, c0202, c0300, c0301, c0302;
c0201 Cell l0201;
l0202 LIST  c0101, c0102, c0103, c0201, c0202, c0203, c0301, c0302, c0303;
c0202 Cell l0202;
l0203 LIST  c0102, c0103, c0104, c0202, c0203, c0204, c0302, c0303, c0304;
c0203 Cell l0203;
l0204 LIST  c0103, c0104, c0105, c0203, c0204, c0205, c0303, c0304, c0305;
c0204 Cell l0204;
l0205 LIST  c0104, c0105, c0106, c0204, c0205, c0206, c0304, c0305, c0306;
c0205 Cell l0205;
l0206 LIST  c0105, c0106, c0107, c0205, c0206, c0207, c0305, c0306, c0307;
c0206 Cell l0206;
l0207 LIST  c0106, c0107, c0108, c0206, c0207, c0208, c0306, c0307, c0308;
c0207 Cell l0207;
l0208 LIST  c0107, c0108, c0109, c0207, c0208, c0209, c0307, c0308, c0309;
c0208 Cell l0208;
l0209 LIST  c0108, c0109, c0100, c0208, c0209, c0200, c0308, c0309, c0300;
c0209 Cell l0209;
r02 LIST  c0200, c0201, c0202, c0203, c0204, c0205, c0206, c0207, c0208, c0209;
l0300 LIST  c0209, c0200, c0201, c0309, c0300, c0301, c0409, c0400, c0401;
c0300 Cell l0300;
l0301 LIST  c0200, c0201, c0202, c0300, c0301, c0302, c0400, c0401, c0402;
c0301 Cell l0301;
l0302 LIST  c0201, c0202, c0203, c0301, c0302, c0303, c0401, c0402, c0403;
c0302 Cell l0302;
l0303 LIST  c0202, c0203, c0204, c0302, c0303, c0304, c0402, c0403, c0404;
c0303 Cell l0303;
l0304 LIST  c0203, c0204, c0205, c0303, c0304, c0305, c0403, c0404, c0405;
c0304 Cell l0304;
l0305 LIST  c0204, c0205, c0206, c0304, c0305, c0306, c0404, c0405, c0406;
c0305 Cell l0305;
l0306 LIST  c0205, c0206, c0207, c0305, c0306, c0307, c0405, c0406, c0407;
c0306 Cell l0306;
l0307 LIST  c0206, c0207, c0208, c0306, c0307, c0308, c0406, c0407, c0408;
c0307 Cell l0307;
l0308 LIST  c0207, c0208, c0209, c0307, c0308, c0309, c0407, c0408, c0409;
c0308 Cell l0308;
l0309 LIST  c0208, c0209, c0200, c0308, c0309, c0300, c0408, c0409, c0400;
c0309 Cell l0309;
r03 LIST  c0300, c0301, c0302, c0303, c0304, c0305, c0306, c0307, c0308, c0309;
l0400 LIST  c0309, c0300, c0301, c0409, c0400, c0401, c0509, c0500, c0501;
c0400 Cell l0400;
l0401 LIST  c0300, c0301, c0302, c0400, c0401, c0402, c0500, c0501, c0502;
c0401 Cell l0401;
l0402 LIST  c0301, c0302, c0303, c0401, c0402, c0403, c0501, c0502, c0503;
c0402 Cell l0402;
l0403 LIST  c0302, c0303, c0304, c0402, c0403, c0404, c0502, c0503, c0504;
c0403 Cell l0403;
l0404 LIST  c0303, c0304, c0305, c0403, c0404, c0405, c0503, c0504, c0505;
c0404 Cell l0404;
l0405 LIST  c0304, c0305, c0306, c0404, c0405, c0406, c0504, c0505, c0506;
c0405 Cell l0405;
l0406 LIST  c0305, c0306, c0307, c0405, c0406, c0407, c0505, c0506, c0507;
c0406 Cell l0406;
l0407 LIST  c0306, c0307, c0308, c0406, c0407, c0408, c0506, c0507, c0508;
c0407 Cell l0407;
l0408 LIST  c0307, c0308, c0309, c0407, c0408, c0409, c0507, c0508, c0509;
c0408 Cell l0408;
l0409 LIST  c0308, c0309, c0300, c0408, c0409, c0400, c0508, c0509, c0500;
c0409 Cell l0409;
r04 LIST  c0400, c0401, c0402, c0403, c0404, c0405, c0406, c0407, c0408, c0409;
l0500 LIST  c0409, c0400, c0401, c0509, c0500, c0501, c0609, c0600, c0601;
c0500 Cell l0500;
l0501 LIST  c0400, c0401, c0402, c0500, c0501, c0502, c0600, c0601, c0602;
c0501 Cell l0501;
l0502 LIST  c0401, c0402, c0403, c0501, c0502, c0503, c0601, c0602, c0603;
c0502 Cell l0502;
l0503 LIST  c0402, c0403, c0404, c0502, c0503, c0504, c0602, c0603, c0604;
c0503 Cell l0503;
l0504 LIST  c0403, c0404, c0405, c0503, c0504, c0505, c0603, c0604, c0605;
c0504 Cell l0504;
l0505 LIST  c0404, c0405, c0406, c0504, c0505, c0506, c0604, c0605, c0606;
c0505 Cell l0505;
l0506 LIST  c0405, c0406, c0407, c0505, c0506, c0507, c0605, c0606, c0607;
c0506 Cell l0506;
l0507 LIST  c0406, c0407, c0408, c0506, c0507, c0508, c0606, c0607, c0608;
c0507 Cell l0507;
l0508 LIST  c0407, c0408, c0409, c0507, c0508, c0509, c0607, c0608, c0609;
c0508 Cell l0508;
l0509 LIST  c0408, c0409, c0400, c0508, c0509, c0500, c0608, c0609, c0600;
c0509 Cell l0509;
r05 LIST  c0500, c0501, c0502, c0503, c0504, c0505, c0506, c0507, c0508, c0509;
l0600 LIST  c0509, c0500, c0501, c0609, c0600, c0601, c0709, c0700, c0701;
c0600 Cell l0600;
l0601 LIST  c0500, c0501, c0502, c0600, c0601, c0602, c0700, c0701, c0702;
c0601 Cell l0601;
l0602 LIST  c0501, c0502, c0503, c0601, c0602, c0603, c0701, c0702, c0703;
c0602 Cell l0602;
l0603 LIST  c0502, c0503, c0504, c0602, c0603, c0604, c0702, c0703, c0704;
c0603 Cell l0603;
l0604 LIST  c0503, c0504, c0505, c0603, c0604, c0605, c0703, c0704, c0705;
c0604 Cell l0604;
l0605 LIST  c0504, c0505, c0506, c0604, c0605, c0606, c0704, c0705, c0706;
c0605 Cell l0605;
l0606 LIST  c0505, c0506, c0507, c0605, c0606, c0607, c0705, c0706, c0707;
c0606 Cell l0606;
l0607 LIST  c0506, c0507, c0508, c0606, c0607, c0608, c0706, c0707, c0708;
c0607 Cell l0607;
l0608 LIST  c0507, c0508, c0509, c0607, c0608, c0609, c0707, c0708, c0709;
c0608 Cell l0608;
l0609 LIST  c0508, c0509, c0500, c0608, c0609, c0600, c0708, c0709, c0700;
c0609 Cell l0609;
r06 LIST  c0600, c0601, c0602, c0603, c0604, c0605, c0606, c0607, c0608, c0609;
l0700 LIST  c0609, c0600, c0601, c0709, c0700, c0701, c0809, c0800, c0801;
c0700 Cell l0700;
l0701 LIST  c0600, c0601, c0602, c0700, c0701, c0702, c0800, c0801, c0802;
c0701 Cell l0701;
l0702 LIST  c0601, c0602, c0603, c0701, c0702, c0703, c0801, c0802, c0803;
c0702 Cell l0702;
l0703 LIST  c0602, c0603, c0604, c0702, c0703, c0704, c0802, c0803, c0804;
c0703 Cell l0703;
l0704 LIST  c0603, c0604, c0605, c0703, c0704, c0705, c0803, c0804, c0805;
c0704 Cell l0704;
l0705 LIST  c0604, c0605, c0606, c0704, c0705, c0706, c0804, c0805, c0806;
c0705 Cell l0705;
l0706 LIST  c0605, c0606, c0607, c0705, c0706, c0707, c0805, c0806, c0807;
c0706 Cell l0706;
l0707 LIST  c0606, c0607, c0608, c0706, c0707, c0708, c0806, c0807, c0808;
c0707 Cell l0707;
l0708 LIST  c0607, c0608, c0609, c0707, c0708, c0709, c0807, c0808, c0809;
c0708 Cell l0708;
l0709 LIST  c0608, c0609, c0600, c0708, c0709, c0700, c0808, c0809, c0800;
c0709 Cell l0709;
r07 LIST  c0700, c0701, c0702, c0703, c0704, c0705, c0706, c0707, c0708, c0709;
l0800 LIST  c0709, c0700, c0701, c0809, c0800, c0801, c0909, c0900, c0901;
c0800 Cell l0800;
l0801 LIST  c0700, c0701, c0702, c0800, c0801, c0802, c0900, c0901, c0902;
c0801 Cell l0801;
l0802 LIST  c0701, c0702, c0703, c0801, c0802, c0803, c0901, c0902, c0903;
c0802 Cell l0802;
l0803 LIST  c0702, c0703, c0704, c0802, c0803, c0804, c0902, c0903, c0904;
c0803 Cell l0803;
l0804 LIST  c0703, c0704, c0705, c0803, c0804, c0805, c0903, c0904, c0905;
c0804 Cell l0804;
l0805 LIST  c0704, c0705, c0706, c0804, c0805, c0806, c0904, c0905, c0906;
c0805 Cell l0805;
l0806 LIST  c0705, c0706, c0707, c0805, c0806, c0807, c0905, c0906, c0907;
c0806 Cell l0806;
l0807 LIST  c0706, c0707, c0708, c0806, c0807, c0808, c0906, c0907, c0908;
c0807 Cell l0807;
l0808 LIST  c0707, c0708, c0709, c0807, c0808, c0809, c0907, c0908, c0909;
c0808 Cell l0808;
l0809 LIST  c0708, c0709, c0700, c0808, c0809, c0800, c0908, c0909, c0900;
c0809 Cell l0809;
r08 LIST  c0800, c0801, c0802, c0803, c0804, c0805, c0806, c0807, c0808, c0809;
l0900 LIST  c0809, c0800, c0801, c0909, c0900, c0901, c0009, c0000, c0001;
c0900 Cell l0900;
l0901 LIST  c0800, c0801, c0802, c0900, c0901, c0902, c0000, c0001, c0002;
c0901 Cell l0901;
l0902 LIST  c0801, c0802, c0803, c0901, c0902, c0903, c0001, c0002, c0003;
c0902 Cell l0902;
l0903 LIST  c0802, c0803, c0804, c0902, c0903, c0904, c0002, c0003, c0004;
c0903 Cell l0903;
l0904 LIST  c0803, c0804, c0805, c0903, c0904, c0905, c0003, c0004, c0005;
c0904 Cell l0904;
l0905 LIST  c0804, c0805, c0806, c0904, c0905, c0906, c0004, c0005, c0006;
c0905 Cell l0905;
l0906 LIST  c0805, c0806, c0807, c0905, c0906, c0907, c0005, c0006, c0007;
c0906 Cell l0906;
l0907 LIST  c0806, c0807, c0808, c0906, c0907, c0908, c0006, c0007, c0008;
c0907 Cell l0907;
l0908 LIST  c0807, c0808, c0809, c0907, c0908, c0909, c0007, c0008, c0009;
c0908 Cell l0908;
l0909 LIST  c0808, c0809, c0800, c0908, c0909, c0900, c0008, c0009, c0000;
c0909 Cell l0909;
r09 LIST  c0900, c0901, c0902, c0903, c0904, c0905, c0906, c0907, c0908, c0909;
